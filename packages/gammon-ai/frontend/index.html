<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé≤ GuruGammon - Play Online</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            background: linear-gradient(90deg, #ffd700, #ffaa00, #ff8c00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
        }

        .game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .board-wrapper {
            position: relative;
            background: linear-gradient(145deg, #8B4513, #654321);
            border-radius: 20px;
            padding: 20px;
            box-shadow:
                0 10px 40px rgba(0, 0, 0, 0.5),
                inset 0 2px 10px rgba(255, 255, 255, 0.1);
        }

        .board {
            display: grid;
            grid-template-columns: repeat(6, 50px) 30px repeat(6, 50px);
            grid-template-rows: repeat(2, 200px);
            gap: 2px;
            background: #2d1810;
            padding: 10px;
            border-radius: 10px;
        }

        .point {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .point:hover {
            transform: scale(1.05);
        }

        .point.dark {
            background: linear-gradient(180deg, #4a2c1a 0%, #3d2415 100%);
        }

        .point.light {
            background: linear-gradient(180deg, #d4a574 0%, #c49a6c 100%);
        }

        .point.top {
            flex-direction: column;
            padding-top: 10px;
        }

        .point.bottom {
            flex-direction: column-reverse;
            padding-bottom: 10px;
        }

        .bar {
            background: #1a0f0a;
            grid-row: span 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .checker {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 2px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8em;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
        }

        .checker.white {
            background: linear-gradient(145deg, #ffffff, #e0e0e0);
            color: #333;
            border: 2px solid #ccc;
        }

        .checker.black {
            background: linear-gradient(145deg, #333, #111);
            color: #fff;
            border: 2px solid #444;
        }

        .checker.selected {
            box-shadow: 0 0 20px #ffd700, 0 0 40px #ffd700;
            transform: scale(1.1);
        }

        .checker-stack {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .checker-stack.stacked .checker:not(:first-child) {
            margin-top: -25px;
        }

        .dice-area {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }

        .die {
            width: 60px;
            height: 60px;
            background: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2em;
            font-weight: bold;
            color: #333;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s;
        }

        .die:hover {
            transform: translateY(-5px);
        }

        .die.used {
            opacity: 0.4;
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        button {
            padding: 15px 30px;
            font-size: 1.1em;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .btn-roll {
            background: linear-gradient(145deg, #ffd700, #ffaa00);
            color: #333;
        }

        .btn-roll:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.5);
        }

        .btn-undo {
            background: linear-gradient(145deg, #666, #444);
            color: white;
        }

        .btn-new {
            background: linear-gradient(145deg, #2ecc71, #27ae60);
            color: white;
        }

        .info-panel {
            display: flex;
            justify-content: space-between;
            width: 100%;
            max-width: 800px;
            margin-top: 20px;
        }

        .player-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px 25px;
            border-radius: 10px;
            text-align: center;
        }

        .player-info.active {
            background: rgba(255, 215, 0, 0.2);
            border: 2px solid #ffd700;
        }

        .pip-count {
            font-size: 2em;
            font-weight: bold;
            color: #48dbfb;
        }

        .message {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px 30px;
            border-radius: 10px;
            margin: 20px 0;
            font-size: 1.2em;
        }

        .off-area {
            position: absolute;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .off-area.white {
            right: -60px;
            top: 20px;
        }

        .off-area.black {
            right: -60px;
            bottom: 20px;
        }

        .off-checker {
            width: 35px;
            height: 12px;
            border-radius: 3px;
        }

        .off-checker.white {
            background: linear-gradient(90deg, #fff, #ddd);
        }

        .off-checker.black {
            background: linear-gradient(90deg, #333, #111);
        }

        @keyframes roll {

            0%,
            100% {
                transform: rotate(0deg);
            }

            25% {
                transform: rotate(90deg);
            }

            50% {
                transform: rotate(180deg);
            }

            75% {
                transform: rotate(270deg);
            }
        }

        .die.rolling {
            animation: roll 0.5s ease-in-out;
        }
    </style>
</head>

<body>
    <h1>üé≤ GuruGammon</h1>

    <div class="game-container">
        <div class="message" id="message">Cliquez sur "Lancer les d√©s" pour commencer!</div>

        <div class="board-wrapper">
            <div class="board" id="board">
                <!-- Points g√©n√©r√©s par JS -->
            </div>

            <div class="off-area white" id="off-white"></div>
            <div class="off-area black" id="off-black"></div>
        </div>

        <div class="dice-area">
            <div class="die" id="die1">?</div>
            <div class="die" id="die2">?</div>
        </div>

        <div class="controls">
            <button class="btn-roll" id="rollBtn" onclick="rollDice()">üé≤ Lancer les d√©s</button>
            <button class="btn-undo" onclick="undoMove()">‚Ü©Ô∏è Annuler</button>
            <button class="btn-new" onclick="newGame()">üÜï Nouvelle partie</button>
        </div>

        <div class="info-panel">
            <div class="player-info" id="white-info">
                <div>‚ö™ BLANC</div>
                <div class="pip-count" id="white-pip">167</div>
                <div>pip count</div>
            </div>
            <div class="player-info" id="black-info">
                <div>‚ö´ NOIR</div>
                <div class="pip-count" id="black-pip">167</div>
                <div>pip count</div>
            </div>
        </div>
    </div>

    <script>
        // √âtat initial du jeu
        let gameState = {
            board: new Array(24).fill(0),
            bar: { white: 0, black: 0 },
            off: { white: 0, black: 0 },
            currentPlayer: 'white',
            dice: [0, 0],
            diceUsed: [false, false],
            selectedPoint: null,
            moveHistory: []
        };

        // Position initiale
        function initBoard() {
            gameState.board = new Array(24).fill(0);
            // Blancs (positifs)
            gameState.board[0] = 2;
            gameState.board[11] = 5;
            gameState.board[16] = 3;
            gameState.board[18] = 5;
            // Noirs (n√©gatifs)
            gameState.board[23] = -2;
            gameState.board[12] = -5;
            gameState.board[7] = -3;
            gameState.board[5] = -5;

            gameState.bar = { white: 0, black: 0 };
            gameState.off = { white: 0, black: 0 };
            gameState.currentPlayer = 'white';
            gameState.dice = [0, 0];
            gameState.diceUsed = [false, false];
            gameState.selectedPoint = null;
            gameState.moveHistory = [];
        }

        function renderBoard() {
            const boardEl = document.getElementById('board');
            boardEl.innerHTML = '';

            // Points 13-24 (haut)
            for (let i = 12; i < 18; i++) {
                boardEl.appendChild(createPoint(i, 'top', i % 2 === 0 ? 'dark' : 'light'));
            }
            boardEl.appendChild(createBar('top'));
            for (let i = 18; i < 24; i++) {
                boardEl.appendChild(createPoint(i, 'top', i % 2 === 0 ? 'dark' : 'light'));
            }

            // Points 1-12 (bas, invers√©)
            for (let i = 11; i >= 6; i--) {
                boardEl.appendChild(createPoint(i, 'bottom', i % 2 === 0 ? 'light' : 'dark'));
            }
            boardEl.appendChild(createBar('bottom'));
            for (let i = 5; i >= 0; i--) {
                boardEl.appendChild(createPoint(i, 'bottom', i % 2 === 0 ? 'light' : 'dark'));
            }

            updatePipCounts();
            updatePlayerIndicator();
            renderOffCheckers();
        }

        function createPoint(index, position, color) {
            const point = document.createElement('div');
            point.className = `point ${position} ${color}`;
            point.dataset.index = index;
            point.onclick = () => handlePointClick(index);

            const checkers = gameState.board[index];
            if (checkers !== 0) {
                const stack = document.createElement('div');
                stack.className = 'checker-stack' + (Math.abs(checkers) > 5 ? ' stacked' : '');

                const count = Math.min(Math.abs(checkers), 5);
                for (let i = 0; i < count; i++) {
                    const checker = document.createElement('div');
                    checker.className = `checker ${checkers > 0 ? 'white' : 'black'}`;
                    if (i === count - 1 && Math.abs(checkers) > 5) {
                        checker.textContent = Math.abs(checkers);
                    }
                    if (gameState.selectedPoint === index) {
                        checker.classList.add('selected');
                    }
                    stack.appendChild(checker);
                }
                point.appendChild(stack);
            }

            return point;
        }

        function createBar(position) {
            const bar = document.createElement('div');
            bar.className = 'bar';

            const color = position === 'top' ? 'black' : 'white';
            const count = gameState.bar[color];

            for (let i = 0; i < count; i++) {
                const checker = document.createElement('div');
                checker.className = `checker ${color}`;
                bar.appendChild(checker);
            }

            return bar;
        }

        function renderOffCheckers() {
            const whiteOff = document.getElementById('off-white');
            const blackOff = document.getElementById('off-black');

            whiteOff.innerHTML = '';
            blackOff.innerHTML = '';

            for (let i = 0; i < gameState.off.white; i++) {
                const c = document.createElement('div');
                c.className = 'off-checker white';
                whiteOff.appendChild(c);
            }

            for (let i = 0; i < gameState.off.black; i++) {
                const c = document.createElement('div');
                c.className = 'off-checker black';
                blackOff.appendChild(c);
            }
        }

        function rollDice() {
            const die1 = document.getElementById('die1');
            const die2 = document.getElementById('die2');

            die1.classList.add('rolling');
            die2.classList.add('rolling');

            setTimeout(() => {
                gameState.dice[0] = Math.floor(Math.random() * 6) + 1;
                gameState.dice[1] = Math.floor(Math.random() * 6) + 1;
                gameState.diceUsed = [false, false];

                die1.textContent = gameState.dice[0];
                die2.textContent = gameState.dice[1];
                die1.classList.remove('rolling', 'used');
                die2.classList.remove('rolling', 'used');

                setMessage(`${gameState.currentPlayer === 'white' ? '‚ö™ Blanc' : '‚ö´ Noir'} a lanc√© ${gameState.dice[0]} et ${gameState.dice[1]}`);

                document.getElementById('rollBtn').disabled = true;
            }, 500);
        }

        function handlePointClick(index) {
            if (gameState.dice[0] === 0) {
                setMessage('Lancez d\'abord les d√©s!');
                return;
            }

            const isWhite = gameState.currentPlayer === 'white';
            const checkers = gameState.board[index];

            if (gameState.selectedPoint === null) {
                // S√©lectionner un pion
                if ((isWhite && checkers > 0) || (!isWhite && checkers < 0)) {
                    gameState.selectedPoint = index;
                    renderBoard();
                    setMessage(`Point ${index + 1} s√©lectionn√©. Cliquez sur la destination.`);
                }
            } else {
                // Essayer de d√©placer
                const from = gameState.selectedPoint;
                const to = index;
                const die = Math.abs(to - from);

                // V√©rifier si le d√© correspond
                const dieIndex = gameState.dice.findIndex((d, i) => d === die && !gameState.diceUsed[i]);

                if (dieIndex !== -1) {
                    // Effectuer le mouvement
                    const value = isWhite ? 1 : -1;
                    gameState.board[from] -= value;

                    // V√©rifier hit
                    if ((isWhite && gameState.board[to] === -1) || (!isWhite && gameState.board[to] === 1)) {
                        gameState.bar[isWhite ? 'black' : 'white'] += 1;
                        gameState.board[to] = 0;
                    }

                    gameState.board[to] += value;
                    gameState.diceUsed[dieIndex] = true;

                    // Mettre √† jour les d√©s visuellement
                    document.getElementById(`die${dieIndex + 1}`).classList.add('used');

                    setMessage(`D√©plac√© de ${from + 1} √† ${to + 1}`);

                    // V√©rifier fin de tour
                    if (gameState.diceUsed.every(u => u)) {
                        endTurn();
                    }
                } else {
                    setMessage('Mouvement invalide!');
                }

                gameState.selectedPoint = null;
                renderBoard();
            }
        }

        function endTurn() {
            gameState.currentPlayer = gameState.currentPlayer === 'white' ? 'black' : 'white';
            gameState.dice = [0, 0];
            document.getElementById('die1').textContent = '?';
            document.getElementById('die2').textContent = '?';
            document.getElementById('rollBtn').disabled = false;

            updatePlayerIndicator();
            setMessage(`Tour de ${gameState.currentPlayer === 'white' ? '‚ö™ Blanc' : '‚ö´ Noir'}`);
        }

        function updatePlayerIndicator() {
            document.getElementById('white-info').classList.toggle('active', gameState.currentPlayer === 'white');
            document.getElementById('black-info').classList.toggle('active', gameState.currentPlayer === 'black');
        }

        function updatePipCounts() {
            let whitePip = 0, blackPip = 0;

            for (let i = 0; i < 24; i++) {
                if (gameState.board[i] > 0) {
                    whitePip += gameState.board[i] * (24 - i);
                } else if (gameState.board[i] < 0) {
                    blackPip += Math.abs(gameState.board[i]) * (i + 1);
                }
            }

            whitePip += gameState.bar.white * 25;
            blackPip += gameState.bar.black * 25;

            document.getElementById('white-pip').textContent = whitePip;
            document.getElementById('black-pip').textContent = blackPip;
        }

        function setMessage(msg) {
            document.getElementById('message').textContent = msg;
        }

        function undoMove() {
            setMessage('Undo non impl√©ment√©');
        }

        function newGame() {
            initBoard();
            renderBoard();
            document.getElementById('die1').textContent = '?';
            document.getElementById('die2').textContent = '?';
            document.getElementById('rollBtn').disabled = false;
            setMessage('Nouvelle partie! Cliquez sur "Lancer les d√©s" pour commencer.');
        }

        // Initialisation
        initBoard();
        renderBoard();
    </script>
</body>

</html>